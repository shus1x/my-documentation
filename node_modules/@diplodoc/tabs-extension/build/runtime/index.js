"use strict";(()=>{var W="yfm-tabs",R="yfm-tab",O="yfm-tab-panel",L="yfm-tab-list",r="active";var T="data-diplodoc-group",G="data-diplodoc-key",x="data-diplodoc-variant",v="data-diplodoc-id",H="defaultTabsGroup-";var h="data-diplodoc-forced";var N="yfm-tabs-dropdown-select";var U="yfm-tabs-vertical";var F=Symbol.for("diplodocTabs");var y=s=>{let t=s.composedPath();return Array.isArray(t)&&t.length>0?t[0]:s.target},Z=s=>{let t=y(s);return!t||!t.matches},Q=s=>Math.abs(s.scrollHeight-s.clientHeight)>1?s:s.parentElement?Q(s.parentElement):void 0,X=(s,t)=>{let e=s.getBoundingClientRect(),g=t.getBoundingClientRect();return{top:e.top-g.top,left:e.left-g.left,scrollTop:t.scrollTop,scrollLeft:t.scrollLeft}};var n={TABS:`.${W}`,TAB_LIST:`.${L}`,TAB:`.${R}`,TAB_PANEL:`.${O}`,VERTICAL_TABS:`.${U}`},f=class{constructor(t){this._onSelectTabHandlers=new Set;this._document=t,this._document.addEventListener("click",e=>{let g=y(e);if(e.target&&this.hideAllDropdown(e.target),Z(e))return;if(this.isElementDropdownSelect(g)){g.classList.toggle(r);return}if(!this.isValidTabElement(g))return;let o=this.getTabDataFromHTMLElement(g);o&&this._selectTab(o,g)}),this._document.addEventListener("keydown",e=>{let g=null;switch(e.key){case"ArrowLeft":{g="left";break}case"ArrowRight":{g="right";break}case"ArrowUp":{g="left";break}case"ArrowDown":{g="right";break}}if(!g)return;let o=y(e);if(Z(e)||!this.isValidTabElement(o))return;let{tabs:c,nodes:a}=this.getTabs(o),I=this.getTabDataFromHTMLElement(o),A=c.findIndex(({key:C})=>(I==null?void 0:I.key)&&C===I.key);if(!I||c.length<=1||A===-1)return;let i=(A+(g==="left"?-1:1)+c.length)%c.length;this.selectTab(c[i]),a[i].focus()})}onSelectTab(t){return this._onSelectTabHandlers.add(t),()=>{this._onSelectTabHandlers.delete(t)}}selectTabById(t,e){let g=this._document.querySelector(`${n.TAB}[${v}="${t}"]`);if(!g||!this.isValidTabElement(g))return;let o=this.getTabDataFromHTMLElement(g);o&&this._selectTab(o,g),e!=null&&e.scrollToElement&&g.scrollIntoView()}selectTab(t){this._selectTab(t)}_selectTab(t,e){let{group:g,key:o,variant:c}=t;if(!g)return;let a=e&&Q(e),I=a&&X(e,a);this.updateHTML({group:g,key:o,variant:c},e,c)>0&&(this.fireSelectTabEvent({group:g,key:o,variant:c},e==null?void 0:e.dataset.diplodocId),I&&this.resetScroll(e,a,I))}updateHTML(t,e,g){switch(g){case"radio":return this.updateHTMLRadio(t,e);case"accordion":return this.updateHTMLAccordion(t,e);case"regular":return this.updateHTMLRegular(t);case"dropdown":return this.updateHTMLDropdown(t)}return 0}updateHTMLRadio(t,e){let{group:g,key:o}=t,{isForced:c,root:a}=this.didTabOpenForce(e),I=c?`.yfm-vertical-tab[${h}="true"]`:"",A=this._document.querySelectorAll(`${n.TABS}[${T}="${g}"] ${n.TAB}[${G}="${o}"]${I}`);c&&(a==null||a.removeAttribute(h));let i=0;return A.forEach(C=>{let m=C.parentNode.children;for(let p=0;p<m.length;p+=2){let[d,b]=[m.item(p),m.item(p+1)],u=d.children.item(0);if(d===C){u.checked?(d.classList.remove("active"),b==null||b.classList.remove("active"),u.removeAttribute("checked")):(d.classList.add("active"),b==null||b.classList.add("active"),u.setAttribute("checked","true"));continue}u.hasAttribute("checked")&&(d.classList.remove("active"),b==null||b.classList.remove("active"),u.removeAttribute("checked")),i++}}),i}updateHTMLRegular(t){let{group:e,key:g}=t,o=this._document.querySelectorAll(`${n.TABS}[${T}="${e}"] ${n.TAB}[${G}="${g}"]`),c=0;return o.forEach(a=>{let I=a;if(!this.isValidTabElement(I)||I.dataset.diplodocIsActive==="true")return;c++;let A=a,i=A.parentNode,C=i==null?void 0:i.parentNode,l=Array.from((i==null?void 0:i.querySelectorAll(n.TAB))||[]),m=Array.from((C==null?void 0:C.children)||[]).filter(d=>d.classList.contains(O)),p=l.indexOf(A);l.forEach((d,b)=>{let u=m[b],B=b===p,D=d;D.dataset.diplodocIsActive=B?"true":"false",d.classList.toggle(r,B),d.setAttribute("aria-selected",B.toString()),d.setAttribute("tabindex",B?"0":"-1"),u.classList.toggle(r,B)})}),c}updateHTMLDropdown(t){let{group:e,key:g}=t,o=this._document.querySelectorAll(`${n.TABS}[${T}="${e}"] ${n.TAB}[${G}="${g}"]`),c=0;return o.forEach(a=>{let I=a.closest(`[${x}=dropdown]`);if(!(I!=null&&I.children))return;let A=I.children.item(0),i=I.children.item(1);A==null||A.classList.remove(r);let C=Array.from((i==null?void 0:i.children)||[]).indexOf(a)+2;for(let l=2;l<I.children.length;l++){let m=I.children.item(l),p=i==null?void 0:i.children.item(l-2);if(c++,C===l){m==null||m.classList.add(r),p.classList.add(r),A.innerHTML=a.innerHTML,A.classList.add("filled");continue}p.classList.remove(r),m.classList.remove(r)}}),c}updateHTMLAccordion(t,e){let{group:g,key:o}=t,c=this._document.querySelectorAll(`${n.TABS}[${T}="${g}"] ${n.TAB}[${G}="${o}"]`),a=0;return c.forEach(I=>{let A=I.closest(`[${x}=accordion]`);if(A!=null&&A.children)for(let i=0;i<A.children.length;i+=2){let C=A.children.item(i),l=A.children.item(i+1);if(a++,I===C){C==null||C.classList.toggle(r),l==null||l.classList.toggle(r);continue}C==null||C.classList.remove(r),l==null||l.classList.remove(r)}}),e&&!this.checkVisible(e)&&setTimeout(()=>{e.scrollIntoView({block:"nearest"})}),a}checkVisible(t){let e=t.getBoundingClientRect(),g=Math.max(document.documentElement.clientHeight,window.innerHeight);return!(e.bottom<0||e.top-g>=0)}hideAllDropdown(t){this._document.querySelectorAll(".yfm-tabs-dropdown-select.active").forEach(g=>{g.contains(t)||g.classList.remove(r)})}resetScroll(t,e,g){let o=X(t,e),c=o.top-g.top,a=o.left-g.left,I=o.scrollTop-g.scrollTop,A=o.scrollLeft-g.scrollLeft;e.scrollTo(e.scrollLeft+a-A,e.scrollTop+c-I)}didTabOpenForce(t){if(!t)return{};if(t.dataset.diplodocForced)return{root:t,isForced:!0};let e=t.dataset.diplodocVerticalTab?t:t.parentElement,g=typeof(e==null?void 0:e.dataset.diplodocForced)!="undefined";return{root:e,isForced:g}}fireSelectTabEvent(t,e){let{group:g,key:o,variant:c}=t,a=g.startsWith(H)?{key:o,variant:c}:t;this._onSelectTabHandlers.forEach(I=>{I({tab:a,currentTabId:e})})}getTabsType(t){let e=t.closest(`[${x}]`);if(e)return e.dataset.diplodocVariant}isValidTabElement(t){return!!this.getTabsType(t)}isElementDropdownSelect(t){return t.classList.contains(N)}getTabDataFromHTMLElement(t){var c,a,I;let e=this.getTabsType(t);if(e==="radio"){let A=t.dataset.diplodocVerticalTab?t:t.parentElement,i=A.dataset.diplodocKey,C=(c=A.closest(n.TABS))==null?void 0:c.dataset.diplodocGroup;return i&&C?{group:C,key:i,variant:"radio"}:null}if(e==="dropdown"||e==="accordion"){let A=t.dataset.diplodocKey,i=(a=t.closest(n.TABS))==null?void 0:a.dataset.diplodocGroup;return A&&i?{group:i,key:A,variant:e}:null}let g=t.dataset.diplodocKey,o=(I=t.closest(n.TABS))==null?void 0:I.dataset.diplodocGroup;return g&&o?{group:o,key:g,variant:"regular"}:null}getTabs(t){var c,a;let e=(c=t.closest(n.TABS))==null?void 0:c.dataset.diplodocGroup,g=(a=t.closest(n.TAB_LIST))==null?void 0:a.querySelectorAll(n.TAB),o=[];return g.forEach(I=>{let A=I==null?void 0:I.dataset.diplodocKey;A&&o.push({group:e,key:A,variant:"regular"})}),{tabs:o,nodes:g}}};typeof window!="undefined"&&typeof document!="undefined"&&!window[F]&&(window[F]=new f(document));})();
//# sourceMappingURL=index.js.map
